@import "tailwindcss";

/* Theme system with CSS custom properties */

/* Default theme - bold, colorful and fun */
:root,
[data-theme="default"] {
  --text-color: #000;
  --ink-color: #000;
  --shadow-color: #000;
  --notice-text: #000;
  --alert-text: #000;

  /* UI colors */
  --bg-body: #fff7ed;
  --bg-card: white;
  --bg-nav: white;
  --accent-primary: #f0abfc; /* fuchsia for logo */
  --accent-cta: #fde047; /* yellow for primary buttons */
  --accent-notice: #bef264; /* lime for notices */
  --accent-alert: #fda4af; /* rose for alerts */

  /* Time-of-day section backgrounds */
  --bg-morning: #fffbeb; /* amber-50 */
  --bg-afternoon: #f0f9ff; /* sky-50 */
  --bg-evening: #eef2ff; /* indigo-50 */

  /* Stats card colors */
  --bg-stat-today: #a7f3d0; /* emerald-200 */
  --bg-stat-week: #bfdbfe; /* blue-200 */
  --bg-stat-alltime: #fde68a; /* amber-200 */

  /* Habit colors (8 vibrant options) */
  --habit-color-1: #fde047; /* yellow-300 */
  --habit-color-2: #bef264; /* lime-300 */
  --habit-color-3: #fda4af; /* rose-300 */
  --habit-color-4: #f0abfc; /* fuchsia-300 */
  --habit-color-5: #7dd3fc; /* sky-300 */
  --habit-color-6: #6ee7b7; /* emerald-300 */
  --habit-color-7: #fdba74; /* orange-300 */
  --habit-color-8: #c4b5fd; /* violet-300 */
}

/* Monochrome Magic theme - elegant grayscale */
[data-theme="monochrome"] {
  --text-color: #111827; /* deep gray text for softer contrast */
  --ink-color: #111827;
  --shadow-color: #111827;
  --notice-text: #111827;
  --alert-text: #111827;

  /* UI colors */
  --bg-body: #f5f5f5;
  --bg-card: white;
  --bg-nav: white;
  --accent-primary: #6b7280; /* gray-500 */
  --accent-cta: #374151; /* gray-700 */
  --accent-notice: #d1d5db; /* gray-300 */
  --accent-alert: #9ca3af; /* gray-400 */

  /* Time-of-day section backgrounds */
  --bg-morning: #fafafa;
  --bg-afternoon: #f5f5f5;
  --bg-evening: #f0f0f0;

  /* Stats card colors */
  --bg-stat-today: #e5e7eb; /* gray-200 */
  --bg-stat-week: #d1d5db; /* gray-300 */
  --bg-stat-alltime: #f3f4f6; /* gray-100 */

  /* Habit colors (8 graduated grays with good contrast) */
  --habit-color-1: #1f2937; /* gray-800 - darkest */
  --habit-color-2: #374151; /* gray-700 */
  --habit-color-3: #4b5563; /* gray-600 */
  --habit-color-4: #6b7280; /* gray-500 */
  --habit-color-5: #9ca3af; /* gray-400 */
  --habit-color-6: #d1d5db; /* gray-300 */
  --habit-color-7: #e5e7eb; /* gray-200 */
  --habit-color-8: #f3f4f6; /* gray-100 - lightest */
}

/* Catppuccin Dark theme - moody neobrutalism */
[data-theme="catppuccin"] {
  --text-color: #cdd6f4;
  --ink-color: #f5e0dc;
  --shadow-color: #050517;
  --text-muted-70: #bac2de;
  --text-muted-50: #a6adc8;
  --text-muted-30: #6c7086;
  --notice-text: #1c1c2b;
  --alert-text: #1c1c2b;
  --surface-overlay-95: rgba(30, 30, 46, 0.95);
  --surface-overlay-50: rgba(30, 30, 46, 0.5);
  --surface-overlay-30: rgba(30, 30, 46, 0.3);
  --surface-overlay-15: rgba(30, 30, 46, 0.15);
  --line-muted-10: rgba(245, 224, 220, 0.2);
  --line-muted-20: rgba(245, 224, 220, 0.35);
  --line-muted-40: rgba(245, 224, 220, 0.55);

  /* UI colors */
  --bg-body: #11111b; /* crust */
  --bg-card: #1e1e2e; /* base */
  --bg-nav: #181825; /* mantle */
  --accent-primary: #cba6f7; /* mauve */
  --accent-cta: #fab387; /* peach */
  --accent-notice: #a6e3a1; /* green */
  --accent-alert: #f38ba8; /* red */

  /* Time-of-day section backgrounds */
  --bg-morning: #1c1c2a;
  --bg-afternoon: #181825;
  --bg-evening: #151521;

  /* Stats card colors */
  --bg-stat-today: #313244; /* surface0 */
  --bg-stat-week: #45475a; /* surface1 */
  --bg-stat-alltime: #585b70; /* surface2 */

  /* Habit colors (Catppuccin signature accents) */
  --habit-color-1: #f38ba8; /* red */
  --habit-color-2: #fab387; /* peach */
  --habit-color-3: #f9e2af; /* yellow */
  --habit-color-4: #a6e3a1; /* green */
  --habit-color-5: #94e2d5; /* teal */
  --habit-color-6: #89b4fa; /* blue */
  --habit-color-7: #cba6f7; /* mauve */
  --habit-color-8: #f5e0dc; /* rosewater */
}

/* Text contrast variables per theme */
:root,
[data-theme="default"] {
  /* Default theme: all habit colors are light, so black text works */
  --habit-text-1: black;
  --habit-text-2: black;
  --habit-text-3: black;
  --habit-text-4: black;
  --habit-text-5: black;
  --habit-text-6: black;
  --habit-text-7: black;
  --habit-text-8: black;
}

[data-theme="monochrome"] {
  /* Monochrome theme: dark colors (1-4) need white text, light colors (5-8) need black text */
  --habit-text-1: white;
  --habit-text-2: white;
  --habit-text-3: white;
  --habit-text-4: white;
  --habit-text-5: black;
  --habit-text-6: black;
  --habit-text-7: black;
  --habit-text-8: black;
}

[data-theme="catppuccin"] {
  /* Catppuccin accents are bright, so deep navy text keeps contrast */
  --habit-text-1: #1c1c2b;
  --habit-text-2: #1c1c2b;
  --habit-text-3: #1c1c2b;
  --habit-text-4: #1c1c2b;
  --habit-text-5: #1c1c2b;
  --habit-text-6: #1c1c2b;
  --habit-text-7: #1c1c2b;
  --habit-text-8: #1c1c2b;
}

/* Neobrutalist-ish design tokens + components (Tailwind v4 CSS-first) */

@layer base {
  html {
    color-scheme: light;
  }

  html[data-theme="catppuccin"] {
    color-scheme: dark;
  }

  body {
    background: var(--bg-body);
    color: var(--text-color, #000);
  }

  a {
    text-decoration: underline;
    text-underline-offset: 4px;
  }

  a:hover {
    text-decoration: none;
  }
}

@layer components {
  .nb-container {
    @apply mx-auto max-w-5xl px-6 py-10;
  }

  .nb-nav {
    @apply border-b-2 border-black;
    background: var(--bg-nav);
    border-color: var(--ink-color, #000);
  }

  .nb-logo {
    @apply grid h-12 w-12 place-items-center border-2 border-black text-lg font-black;
    background: var(--accent-primary);
    border-color: var(--ink-color, #000);
    box-shadow: 4px 4px 0 var(--shadow-color, #000);
  }

  .nb-page {
    @apply grid gap-6;
  }

  .nb-page-header {
    @apply flex flex-col gap-3 border-2 border-black py-2 px-4 md:p-6 md:gap-4 sm:flex-row sm:items-end sm:justify-between;
    background: var(--bg-card);
    border-color: var(--ink-color, #000);
    box-shadow: 4px 4px 0 var(--shadow-color, #000);
  }
  @media (min-width: 768px) {
    .nb-page-header {
      box-shadow: 8px 8px 0 var(--shadow-color, #000);
    }
  }

  .nb-card {
    @apply border-2 border-black p-6;
    background: var(--bg-card);
    border-color: var(--ink-color, #000);
    box-shadow: 8px 8px 0 var(--shadow-color, #000);
  }

  .nb-card--tight {
    @apply p-4;
    box-shadow: 6px 6px 0 var(--shadow-color, #000);
  }

  .nb-card--notice {
    background: var(--accent-notice);
    color: var(--notice-text, var(--text-color));
  }

  .nb-card--alert {
    background: var(--accent-alert);
    color: var(--alert-text, var(--text-color));
  }

  .nb-label {
    @apply text-xs font-black uppercase tracking-widest;
  }

  .nb-input {
    @apply w-full border-2 border-black px-3 py-2 font-medium outline-none;
    background: var(--bg-card);
    border-color: var(--ink-color, #000);
    box-shadow: 3px 3px 0 var(--shadow-color, #000);
  }

  .nb-input:focus {
    transform: translate(-1px, -1px);
    box-shadow: 5px 5px 0 var(--shadow-color, #000);
  }

  .nb-pill {
    @apply inline-flex items-center gap-2 border-2 border-black px-2 py-1 text-xs font-black;
    border-color: var(--ink-color, #000);
    box-shadow: 3px 3px 0 var(--shadow-color, #000);
  }

  .nb-pill--white {
    background: var(--bg-card);
    color: var(--text-color, black);
  }

  .nb-btn {
    @apply inline-flex items-center justify-center gap-2 border-2 border-black px-4 py-2 text-sm font-black transition;
    border-color: var(--ink-color, #000);
    box-shadow: 4px 4px 0 var(--shadow-color, #000);
    color: black; /* Default to black text */
  }

  .nb-btn:hover {
    transform: translate(-1px, -1px);
    box-shadow: 6px 6px 0 var(--shadow-color, #000);
  }

  .nb-btn--yellow {
    background: var(--accent-cta);
  }

  /* Ensure text contrast on CTA button in monochrome */
  [data-theme="monochrome"] .nb-btn--yellow {
    color: white;
  }

  .nb-btn--white {
    background: var(--bg-card);
    color: var(--text-color, black);
  }

  .nb-btn--red {
    background: var(--accent-alert);
    color: black; /* Always black text */
  }

  .nb-checkbox-label {
    @apply flex items-center gap-2 p-3 border-2 rounded cursor-pointer transition-colors;
    border-color: var(--ink-color, #000);
    background: var(--bg-card);
  }

  .nb-checkbox-label:hover {
    background: color-mix(in srgb, var(--accent-cta) 20%, var(--bg-card));
  }

  .nb-checkbox {
    @apply w-5 h-5;
    accent-color: var(--accent-cta);
  }

  /* Timeline styles */
  .timeline-container {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }

  .timeline-section {
    position: relative;
  }

  .timeline-hour {
    user-select: none;
    -webkit-user-select: none;
    transition: background-color 0.1s ease;
    /* Allow scrolling on mobile - don't set touch-action: none here */
  }

  /* Desktop: draggable main area */
  @media (min-width: 768px) {
    .timeline-hour .hour-content {
      touch-action: none;
      cursor: crosshair;
    }

    .timeline-hour:hover .hour-content {
      background-color: rgba(0, 0, 0, 0.04);
    }

    .timeline-hour:hover .hour-content::after {
      content: "";
      position: absolute;
      inset: 2px;
      border: 2px dashed rgba(0, 0, 0, 0.15);
      border-radius: 0.5rem;
      pointer-events: none;
    }
  }

  /* Drag handle - the dedicated touch zone for mobile */
  .drag-handle {
    touch-action: none;
    -webkit-touch-callout: none;
    background: repeating-linear-gradient(
      45deg,
      transparent,
      transparent 4px,
      rgba(0, 0, 0, 0.03) 4px,
      rgba(0, 0, 0, 0.03) 8px
    );
    transition: background-color 0.15s ease;
  }

  .drag-handle:hover,
  .drag-handle:active {
    background-color: rgba(0, 0, 0, 0.08);
  }

  .drag-handle:active span {
    transform: scale(1.2);
  }

  /* Hide drag handle on desktop since whole row is draggable */
  @media (min-width: 768px) {
    .drag-handle {
      display: none;
    }
  }

  /* Time-of-day backgrounds */
  .bg-morning {
    background: var(--bg-morning);
  }

  .bg-afternoon {
    background: var(--bg-afternoon);
  }

  .bg-evening {
    background: var(--bg-evening);
  }

  /* Stats card backgrounds */
  .bg-stat-today {
    background: var(--bg-stat-today);
  }

  .bg-stat-week {
    background: var(--bg-stat-week);
  }

  .bg-stat-alltime {
    background: var(--bg-stat-alltime);
  }

  /* Habit color utility classes - include text color for contrast */
  .habit-bg-1 {
    background: var(--habit-color-1);
    color: var(--habit-text-1);
  }
  .habit-bg-2 {
    background: var(--habit-color-2);
    color: var(--habit-text-2);
  }
  .habit-bg-3 {
    background: var(--habit-color-3);
    color: var(--habit-text-3);
  }
  .habit-bg-4 {
    background: var(--habit-color-4);
    color: var(--habit-text-4);
  }
  .habit-bg-5 {
    background: var(--habit-color-5);
    color: var(--habit-text-5);
  }
  .habit-bg-6 {
    background: var(--habit-color-6);
    color: var(--habit-text-6);
  }
  .habit-bg-7 {
    background: var(--habit-color-7);
    color: var(--habit-text-7);
  }
  .habit-bg-8 {
    background: var(--habit-color-8);
    color: var(--habit-text-8);
  }

  /* Habit text contrast via data-token attribute (for elements using inline background styles) */
  [data-token="1"] {
    color: var(--habit-text-1);
  }
  [data-token="2"] {
    color: var(--habit-text-2);
  }
  [data-token="3"] {
    color: var(--habit-text-3);
  }
  [data-token="4"] {
    color: var(--habit-text-4);
  }
  [data-token="5"] {
    color: var(--habit-text-5);
  }
  [data-token="6"] {
    color: var(--habit-text-6);
  }
  [data-token="7"] {
    color: var(--habit-text-7);
  }
  [data-token="8"] {
    color: var(--habit-text-8);
  }
}

@layer utilities {
  [data-theme="catppuccin"] .text-black {
    color: var(--text-color, #cdd6f4) !important;
  }

  [data-theme="catppuccin"] .text-black\/70 {
    color: var(--text-muted-70, #bac2de) !important;
  }

  [data-theme="catppuccin"] .text-black\/50 {
    color: var(--text-muted-50, #a6adc8) !important;
  }

  [data-theme="catppuccin"] .text-black\/30 {
    color: var(--text-muted-30, #6c7086) !important;
  }

  [data-theme="catppuccin"] .bg-white {
    background-color: var(--bg-card) !important;
    color: var(--text-color) !important;
  }

  [data-theme="catppuccin"] .bg-white\/95 {
    background-color: var(--surface-overlay-95, rgba(30, 30, 46, 0.95)) !important;
  }

  [data-theme="catppuccin"] .bg-white\/50 {
    background-color: var(--surface-overlay-50, rgba(30, 30, 46, 0.5)) !important;
  }

  [data-theme="catppuccin"] .bg-black\/10 {
    background-color: var(--surface-overlay-15, rgba(30, 30, 46, 0.15)) !important;
  }

  [data-theme="catppuccin"] .bg-black\/50 {
    background-color: rgba(5, 5, 23, 0.7) !important;
  }

  [data-theme="catppuccin"] .border-black {
    border-color: var(--ink-color, #f5e0dc) !important;
  }

  [data-theme="catppuccin"] .border-black\/10 {
    border-color: var(--line-muted-10, rgba(245, 224, 220, 0.2)) !important;
  }

  [data-theme="catppuccin"] .border-black\/20 {
    border-color: var(--line-muted-20, rgba(245, 224, 220, 0.35)) !important;
  }

  [data-theme="catppuccin"] .border-black\/40 {
    border-color: var(--line-muted-40, rgba(245, 224, 220, 0.55)) !important;
  }
}
